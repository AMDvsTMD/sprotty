grammar io.typefox.sprotte.example.multicore.MulticoreAllocation with org.eclipse.xtext.common.Terminals

import "http://www.eclipse.org/emf/2002/Ecore" as ecore
generate multicoreAllocation "http://www.typefox.io/sprotte/example/multicore/MulticoreAllocation"

Schedule:
	'schedule' name=ID 'for' numberOfCores=INT 'cores'
	declarations+=Declaration*;

Declaration:
	Task | CoreAllocation;

Task:
	'task' name=ID;

CoreAllocation:
	'core' selectors+=CoreSelector (',' selectors+=CoreSelector)* '{'
		statements+=Statement*
	'}';

CoreSelector:
	from=INTEGER ('..' to=INTEGER)?;

Statement:
	ExecuteStatement | LoopStatement | SendStatement | ReceiveStatement;

ExecuteStatement:
	'execute' task=[Task];

LoopStatement:
	{Loop}
	'loop' (times=INTEGER 'times')? '{'
		statements+=Statement*
	'}';

SendStatement:
	'send' 'to' direction=Direction;

ReceiveStatement:
	'receive' 'from' direction=Direction;

enum Direction:
	north | east | south | west;

terminal INTEGER returns ecore::EIntegerObject:
	('0'..'9')+;
